# Chapter 03: 머신 러닝 핵심 알고리즘
## 02. 비지도 학습
- 비지도 학습: 지도 학습처럼 레이블이 필요하지 않으며 정답이 없는 상태에서 훈련시키는 방식
- 비지도 학습 유형: 군집(clustering), 차원 축소(dimensionality reduction)
- 군집: 각 데이터의 유사성(거리)을 측정한 후 유사성이 높은(거리가 짧은) 데이터끼리 집단으로 분류하는 것
- 차원 축소: 차원을 나타내는 특성을 줄여서 데이터를 줄이는 방식
- 군집과 차원 축소 차이:

|구분|군집|차원 축소|
|:---:|:---:|:---:|
|목표|데이터 그룹화|데이터 간소화|
|주요 알고리즘|K-평균 군집화 (K-means)|주성분 분석 (PCA)|
|예시|사용자의 관심사에 따라 그룹화하여 마케팅에 활용|데이터 압축, 중요한 속성 도출|

> #### 군집, 군집화, 클러스터
> - 통계학에서는 군집이라고 하며, 머신 러닝에서는 클러스터라고 한다.
> - 클러스터를 한국어로 바꾸면 군집화가 된다.
> - 군집, 군집화, 클러스터는 같은 의미의 다른 표현이다.
> - 이 책에서는 군집, 군집화, 클러스터 용어를 혼용하여 사용하지만, 모두 동일한 의미이다.

> #### 데이터 간 유사도(거리) 측정 방법
> - 데이터 간 유사도(거리)를 측정하는 방법: 유클리드 거리, 맨해튼 거리, 민코프스키 거리, 코사인 유사도, 등

### 2-1. K-평균 군집화
- 사용하는 이유: 주어진 데이터에 대한 군집화
- 언제 사용하면 좋은가?: 주어진 데이터셋을 이용하여 몇 개의 클러스터를 구성할지 사전에 알 수 있을 때 사용하면 유용하다.
- K-평균 군집화(K-means clustering): 데이터를 입력받아 소수의 그룹으로 묶는 알고리즘
- 레이블이 없는 데이터를 입력받아 각 데이터에 레이블을 할당해서 군집화를 수행한다.
- 학습 과정:
    1. 중심점 선택: 랜덤하게 초기 중심점(centroid)을 선택한다 (그림에서는 K=2로 초기화).
    2. 클러스터 할당: K개의 중심점과 각각의 개별 데이터 간의 거리(distance)를 측정한 후, 가장 가까운 중심점을 기준으로 데이터를 할당(assign)한다.
    - 이 과정을 통해 클러스터가 구성된다(이때 클러스터링은 데이터를 하나 혹은 둘 이상의 덩어리로 묶는 과정이며, 클러스터는 덩어리 자체를 의미한다).
    3. 새로운 중심점 선택: 클러스터마다 새로운 중심점을 계산한다.
    4. 범위 확인(convergence): 선택된 중심점에 더 이상의 변화가 없다면 진행을 멈춘다. 만약 계속 변화가 있다면 2~3 과정을 반복한다.

![](./assets/Algorithm30.jpg)

- K-평균 군집화 알고리즘은 다음 상황에서는 데이터 분류가 원하는 결과와 다르게 발생할 수 있으므로 사용하지 않는 것이 좋다.
- 데이터가 비선형일 때: ![](./assets/Algorithm31.jpg)

- 군집의 크기가 다를때: ![](./assets/Algorithm32.jpg)

- 군집마다 밀집도(density)와 거리가 다를 때: ![](./assets/Algorithm33.jpg)

- K-평균 군집화 알고리즘의 성능은 K 값에 따라 달라진다.
- 이번 예제는 적절한 K 값을 찾는 것을 목표로 진행한다.

![](./assets/Algorithm34.jpg)

- 필요한 라이브러리를 호출한다.
```py
# 3-29. 라이브러리 호출

import pandas as pd
from sklearn.preprocessing import MinMaxScaler
from sklearn.cluster import KMeans
import matplotlib.pyplot as plt
```
- 예제 폴더의 data 폴더에서 상품에 대한 연 지출 데이터(sales data.csv) 파일을 불러온다.
```py
# 3-30. 상품에 대한 연 지출 데이터(sales data.csv) 호출

data = pd.read_csv('/Users/ramy/PycharmProjects/Pytorch/080289/chap03/data/sales data.csv')
data.head()
```
- 출력은 아래와 같다.

![](./assets/Practice15.png)
