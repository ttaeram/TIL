# Chapter 02: 처음 해보는 딥러닝
## 01. 미지의 일을 예측하는 힘
- **기존 환자의 데이터를 이용해 새로운 환자의 생사를 예측하는 프로그램을 짜봐**
- 위 과제를 받았다고 가정하자.
- 기존의 프로그래밍 기법으로 이런 프로그램을 만들기는 쉽지 않다.
- 기존의 프로그래밍은 데이터를 입력해서 답을 구하는데 초점을 맞췄다.
- 머신러닝은 데이터 안의 규칙을 발견하고 그 규칙을 새로운 데이터에 적용해서 새로운 결과를 도출하는데 초점을 맞춘다.
- 예를 들어 의사가 수많은 환자를 수술해 오던 중 질문을 던져 보았다.
- "혹시 수술하기 전에 수술 후의 생존율을 수치로 예측할 방법이 없을까?"
- 자신이 집도한 수술 환자의 수술 전 상태와 수술 후의 생존율을 정리해 놓은 데이터를 머신러닝 알고리즘에 넣으면 가능하다.
- 학습 (training): 데이터가 입력되고 패턴이 분석되는 과정
- 우리가 배우려는 것이 이러한 학습과 예측의 구체적인 과정이다.
- 1950년대부터 학자들이 더 정확한 예측을 하고자 여러 방법을 고안했다.
- 랜덤 포레스트 (random forest), 서포트 벡터 머신 (support vector machine) 등이 있다.
- 딥러닝은 이러한 수많은 머신러닝 방법 가운데 가장 효과적인 방법이다.

## 02. 폐암 수술 환자의 생존율 예측하기
- 딥러닝 코드를 보며 구성을 살펴보자
- 앞서 얘기한 수술 환자의 생존율 예측 알고리즘을 보면 아래와 같다.
```py
# deep_code/01_My_First_Deeplearning.py

from keras.models import Sequential
from keras.layers import Dense, Input

import numpy
import tensorflow as tf

# 실행할 때마다 같은 결과를 출력하기 위해 설정하는 부분입니다.
seed = 0
numpy.random.seed(seed)
tf.random.set_seed(seed)  # 여기 수정

# 준비된 수술 환자 데이터를 불러들입니다.
Data_set = numpy.loadtxt("../dataset/ThoraricSurgery.csv", delimiter=",")

# 환자의 기록과 수술 결과를 X와 Y로 구분하여 저장합니다.
X = Data_set[:,0:17]
Y = Data_set[:,17]

# 딥러닝 구조를 결정합니다(모델을 설정하고 실행하는 부분입니다).
model = Sequential()
model.add(Input(shape=(17,)))  # 입력 형태를 Input 레이어로 정의
model.add(Dense(30, activation='relu'))
model.add(Dense(1, activation='sigmoid'))

# 딥러닝을 실행합니다.
model.compile(loss='mean_squared_error', optimizer='adam', metrics=['accuracy'])
model.fit(X, Y, epochs=30, batch_size=10)

# 결과를 출력합니다.
print("\n Accuracy: %.4f" % (model.evaluate(X, Y)[1]))
```
- 위 코드를 실행하면 아래와 같은 출력이 나온다.
```
...(중략)
Epoch 25/30
47/47 ━━━━━━━━━━━━━━━━━━━━ 0s 495us/step - accuracy: 0.8637 - loss: 0.1218
Epoch 26/30
47/47 ━━━━━━━━━━━━━━━━━━━━ 0s 449us/step - accuracy: 0.8637 - loss: 0.1265  
Epoch 27/30
47/47 ━━━━━━━━━━━━━━━━━━━━ 0s 441us/step - accuracy: 0.8648 - loss: 0.1211
Epoch 28/30
47/47 ━━━━━━━━━━━━━━━━━━━━ 0s 441us/step - accuracy: 0.8649 - loss: 0.1245  
Epoch 29/30
47/47 ━━━━━━━━━━━━━━━━━━━━ 0s 508us/step - accuracy: 0.8647 - loss: 0.1189
Epoch 30/30
47/47 ━━━━━━━━━━━━━━━━━━━━ 0s 498us/step - accuracy: 0.8636 - loss: 0.1196
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 825us/step - accuracy: 0.8366 - loss: 0.1462

 Accuracy: 0.8511
```
- 맨 아래 줄의 Accuracy를 눈여겨 봐야 한다.
- 정확도가 1.0이면 예측 정확도가 100%라는 뜻이다.
- 따라서 위 코드의 정확도는 85.11%인 것이다.
- 예측 성공률은 입력 데이터의 면밀한 분석과 프로젝트에 맞는 옵션을 가미할 때 더욱 높아진다.
- 이러한 최적화 단계를 제대로 해내려면 딥러닝의 구동 원리를 이해해야 한다.
