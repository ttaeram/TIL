# Chapter 27: 토픽, 서비스, 액션 인터페이스
## 01. ROS 2 인터페이스 (interface) 신규 작성
- ROS 2 프로그래밍은 노드간의 메시지 통신을 위해 정수(integer), 부동 소수점(floating point), 불(boolean)같은 기본 인터페이스를 모아둔 std_msgs이나 병진속도 x, y, z, 회전속도 x, y, z를 표현할 수 있는 geometry_msgs의 Twist.msg 인터페이스, 레이저 스캐닝 값을 담을 수 있는 sensor_msgs의 LaserScan.msg과 같은 이미 만들어 놓은 인터페이스를 사용하는 것이 일반적이다.
- 하지만 이러한 인터페이스들이 유저가 원하는 모든 정보를 담을 수는 없고 토픽 인터페이스 이외에 서비스나 액션 인터페이스는 매우 기본적인 인터페이스만 제공하기에 사용자가 원하는 정보의 형태가 아니라면 새로 만들어 써야 한다.
- 이번 강좌에서는 ROS 2 기초 프로그래밍 예제에서 사용할 토픽(Topic), 서비스(Service), 액션(Action) 관련 ROS 2 인터페이스 (Interface)를 신규로 작성하려고 한다.
- 참고로 ROS 2 인터페이스는 이 인터페이스를 사용하려는 패키지에 포함시켜도 되지만 경험상 인터페이스으로만 구성된 패키지를 별도로 만들어 사용하는 것이 의존성면에서 관리하기 편하다.
- 예를 들어 A라는 패키지에서 a라는 인터페이스를 사용한다고 했을 때 a라는 인터페이스를 사용하는 B, C라는 패키지가 있다면 B와 C패키지는 a 인터페이스가 담긴 A라는 패키지를 통째로 의존하기 때문이다.
- 이러한 이유로 인터페이스는 별도의 독립된 패키지로 구성해야한다. (예: geometry_msgs, turtlebot3_msgs)
- 우리는 이 강좌에서 msg_srv_action_interface_example 이라는 이름의 패키지를 만들 것이고 이 인터페이스 전용 패키지에는 아래와 같이 msg 인터페이스 1개, srv 인터페이스 1개, action 인터페이스 1개를 포함시킬 것이다.
    - ArithmeticArgument.msg
    - ArithmeticOperator.srv
    - ArithmeticChecker.action
    
## 02. 인터페이스 패키지 만들기
- 워크스페이스의 src 폴더로 이동 후 앞선 강좌에서 익힌 `ros2 pkg create` 명령어를 이용하여 msg_srv_action_interface_example 이라는 패키지를 만들어주자.
- 그 뒤에 아래와 같이 인터페이스 파일을 담을 msg, srv, action 폴더를 생성해주자.
```
$ cd ~/robot_ws/src
$ ros2 pkg create --build-type ament_cmake msg_srv_action_interface_example
$ cd msg_srv_action_interface_example
$ mkdir msg srv action
```
- 그 뒤 2.1, 2.2, 2.3 과 같은 내용을 담은 각 인터페이스 파일을 `ArithmeticArgument.msg`, `ArithmeticOperator.srv`, `ArithmeticChecker.action`이라는 이름으로 신규로 작성하여 각각 msg, srv, action 폴더에  파일을 만들어 넣어주자.
- 참고로 '023 ROS 프로그래밍 규칙 (코드 스타일)'에서 언급한 것과 같이 ROS 2 인터페이스 류의 파일명은 `CamelCased` 규칙을 따른다.
- 그 이유는 *.msg 및 *.srv 또는 *.action는 *.h(pp) 변환 후 인터페이스 타입으로 구조체 및 타입으로 사용되기 때문이다.
```
├── action
│   └── ArithmeticChecker.action
├── msg
│   └── ArithmeticArgument.msg
└── srv
    └── ArithmeticOperator.srv
```

### 2-1. ArithmeticArgument.msg 생성
- 저장 위치: msg_srv_action_interface_example/msg
```
# Messages
builtin_interfaces/Time stamp
float32 argument_a
float32 argument_b
```

### 2-2. ArithmeticOperator.srv 생성
- 저장 위치: msg_srv_action_interface_example/srv
```
# Constants
int8 PLUS = 1
int8 MINUS = 2
int8 MULTIPLY = 3
int8 DIVISION = 4

# Request
int8 arithmetic_operator
---
# Response
float32 arithmetic_result
```

### 2-3. ArithmeticChecker.action 생성
- 저장 위치: msg_srv_action_interface_example/action
```
# Goal
float32 goal_sum
---
# Result
string[] all_formula
float32 total_sum
---
# Feedback
string[] formula
```
