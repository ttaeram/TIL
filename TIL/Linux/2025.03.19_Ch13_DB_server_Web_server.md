# Chapter 13: DB 서버와 Web 서버
## 00. 개요
- MariaDB와 웹서버를 다룬다.
- MariaDB로 데이터베이스를 구축하고 사용할 수 있으며, 아파치 웹 서버를 사용하여 웹 서비스를 제공하고, APM을 연동하여 게시판 같은 웹 응용 프로그램을 활용할 수 있다.

## 01. 데이터베이스
- 데이터베이스는 데이터를 모아놓은 것을 의미한다.
- 서로 관련성 있는 데이터들을 데이터 간의 중복성을 최소화해서 체계적으로 모아 놓은 것이 데이터베이스이다.
- 현재는 데이터를 테이블 구조로 구성하는 관계형 데이터베이스가 널리 사용되고 있다.

### 관계형 데이터베이스의 기본 개념
- 데이터를 테이블로 표현한다.
- 데이터를 항목으로 구분하여 테이블로 구성한다.
- 테이블의 생성이나 항목의 분할과 결합을 자유롭게 할 수 있어서 편리하다.

#### 1. 관계형 데이터베이스 관련 용어
- 데이터: 각 항목에 저장되는 값이다.
- 테이블: 데이터를 체계화하여 행과 열의 형태로 구성한 것으로 테이블 이름을 붙인다.
- 데이터베이스: 관련 있는 데이터를 체계적으로 저장한 것으로, 데이터는 테이블 형태로 저장된다. 데이터 베이스는 하나 이상의 테이블이 있을 수 있다. 데이터베이스 이름을 붙인다.
- 필드: 테이블의 열을 의미하며 칼럼이라고도 한다.
- 레코드: 테이블에 저장한 한 행의 정보를 의미하며 튜플이라고도 한다. 한 행에는 여러 필드의 값이 저장될 수 있다.
- 키: 레코드를 구성하는 필드에서 각 레코드를 구분할 수 있는 필드 값을 말한다. 키로 선택된 필드의 값은 중복될 수 없다. 키는 기본 키와 그 외 다른 키가 있을 수 있다.

### SQL 기초
- 관계형 데이터베이스를 생성하고, 테이블을 만들고, 데이터를 입력, 삭제, 수정할 때 사용하는 언어
- Structed Query Language

#### 1. 데이터베이스 관련 SQL
- SQL의 각 문장은 C언어처럼 `;`로 끝나야 한다.
- 특별히 지정하지 않으면 기본적으로 대문자 소문자 구별이 없다.

#### 1-1. 데이터베이스 목록 확인
- 기존 데이터베이스 목록을 출력한다.
```sql
SHOW DATABASES;
```

#### 1-2. 데이터베이스 생성
- 새로운 데이터베이스를 생성한다.
- 데이터베이스를 생성하면 이름만 있을 뿐 내용이 아무것도 없다.
```sql
CREATE DATABASE 데이터베이스명;
```

#### 1-3. 데이터베이스 삭제
- 지정한 데이터베이스를 삭제한다.
- 데이터베이스를 삭제하면 해당 데이터베이스에 있던 모든 테이블도 함께 삭제된다.
```sql
DROP DATABASE 데이터베이스명;
```

#### 1-4. 사용할 데이터베이스 지정
- 여러 데이터베이스 중에서 작업할 데이터베이스를 선택한다.
```sql
USE 데이터베이스명;
```

#### 2. 테이블 관련 SQL
#### 2-1. 테이블 목록 확인
- 현재 데이터베이스에 있는 테이블의 목록을 출력한다.
```sql
SHOW TABLES;
```

#### 2-2. 테이블 생성
- 새로운 테이블을 생성하려면 사용할 수 있는 자료형을 알아야 한다.

|자료형|설명|예|
|:---:|:---:|:---:|
|`varchar(n)`|최대 n의 크기를 가진 가변 문자열|`varchar(10)`|
|`char(n)`|n개의 크기를 가진 고정 문자열|`char(5)`|
|`int`|정수형 숫자|`10`|
|`float`|실수형 숫자|`10.1`|
|`date`|날짜|`2021-08-09`|
|`time`|시간|`02:56:30`|

- 테이블을 생성할 때는 테이블의 구조를 정의하여야 한다.
```sql
CREATE TABLE 테이블명(
    필드명1 필드명1의자료형,
    필드명2 필드명2의자료형,
    ...
);
```

#### 2-3. 테이블의 구조 확인
- 지정한 테이블의 구조를 출력한다.
```sql
EXPLAIN 테이블명;
```

#### 2-4. 테이블 수정
- 테이블의 구조를 변경한다.
```sql
ALTER TABLE 테이블명 수정 명령;
```
- 태이블에 필드 추가 예시
```sql
ALTER TABLE st_info ADD AGE int;
```
- 필드의 자료형 변경 예시
```sql
ALTER TABLE st_info MODIFY AGE float;
```
- 필드 삭제 예시
```sql
ALTER TABLE st_info DROP COLUMN AGE;
```
- 기본 키 추가 예시
```sql
ALTER TABLE st_info ADD CONSTRAINT pk_stinfo PROMARY KEY (ST_ID);
```

#### 2-5. 테이블 삭제
- 지정한 테이블을 삭제한다.
```sql
DROP TABLE 테이블명;
```

#### 3. 레코드 삽입, 삭제, 수정 관련 SQL
- 테이블에 데이터를 입력하거나 삭제할 때는 레코드 단위로 작업한다.

#### 3-1. 레코드 삽입
- 테이블에 새로운 레코드를 추가한다.
- 삽입하는 레코드는 테이블을 생성할 때 지정한 자료형에 맞는 데이터를 입력해야 한다.
```sql
INSERT INTO 테이블명 VALUES (
    값1,
    값2,
    ...
);
```

#### 3-2. 레코드 수정
- 기존의 레코드를 수정한다.
- 조건에 맞는 레코드를 찾아 지정한 필드의 값을 수정한다.
```sql
UPDATE 테이블명 SET
    필드명1=수정할값1,
    필드명2=수정할값2,
    ...
WHERE 조건;
```

#### 3-3. 레코드 삭제
- 테이블에서 해당 레코드를 삭제한다.
```sql
DELETE FROM 테이블명
WHERE 조건;
```

#### 4. 레코드 검색 관련 SQL
- 테이블에 저장된 레코드를 검색할 때는 `SELECT` 문을 사용한다.
```sql
SELECT
    필드명1,
    필드명2,
    ...
FROM 테이블명
WHERE 조건;
```

#### 5. 접근 권한 관련 SQL
- 시스템 관리자가 데이터베이스를 만들고 일반 사용자들이 사용하도록 설정해야 할 때, `GRANT` 문을 사용한다.
- 관리자가 데이터베이스를 만들고, 이 데이터베이스에 대한 모든 권한을 해당 사용자에게 부여하는 것이다.
```sql
GRANT ALL PRIVILEGES
ON DB명.*
TO 사용자 계정@localhost
INDENTIFIED BY '패스워드';
```