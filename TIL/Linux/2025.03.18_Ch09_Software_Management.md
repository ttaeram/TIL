# Chapter 09: 소프트웨어 관리
## 00. 개요
- 리눅스를 설치할 때 기본적인 패키지가 설치되지만 필요에 따라 패키지를 설치하거나 삭제하기도 한다.
- 다양한 패키지를 설치하거나 소스를 직접 컴파일하여 설치할 수 있어야 한다.
- 우분투 리눅스는 데비안 형식의 패키지를 사용한다.
- 우분투 16.04부터는 스냅 형식의 패키지를 도입했다.
- 스냅 패키지는 의존성 있는 파일 모두 포함한 형식으로 모바일 등 플랫폼 확장을 염두에 둔 것이다.
- 시스템 관리자라면 아카이브 파일을 생성하고 푸는 명령과 압축 명령의 사용법을 알아야 한다.

## 01. 우분투 패키지의 개요
- 리눅스에서 소프트웨어는 소스 코드 형식 또는 바로 설치하여 사용할 수 있는 패키지 형태로 배포된다.
- 소스 코드로 배포하는 경우, 대부분 하나의 아카이브 파일로 묶을 후 압축하여 배포한다.
- 바이너리 패키지로 배포하는 경우, 리눅스에서 주로 사용하는 패키지는 RPM과 deb이다.
- 우분투는 기본적으로 deb 형식의 패키지를 사용한다.
- RPM 형식은 레드햇 계열에서 주로 사용한다.
- 우분투 16.04부터 도입된 스냅 패키지는 기존 패키지 형식의 의존성 문제를 해결한 것이다.

### 우분투 패키지의 특징
- 바이너리 파일로 구성되어 있어 컴파일이 필요 없다.
- 패키지의 파일이 관련 디렉토리에 바로 설치된다.
- 패키지를 삭제할 때 관련된 파일을 일괄적으로 삭제할 수 있다.
- 기존에 설치한 패키지를 삭제하지 않고 바로 업그레이드 할 수 있다.
- 패키지의 설치 상태를 검증할 수 있다.
- 패키지에 대한 정보를 제공한다.
- 해당 패키지가 의존하는 패키지가 무엇인지 알려준다. 따라서 의존성이 있는 패키지를 미리 설치할 수도 있고, `apt-get` 명령을 사용하면 의존성이 있는 패키지가 자동으로 설치된다.

### 우분투 패키지의 카테고리
- `main`: 우분투에 의해 공식적으로 지원되며 자유롭게 배포할 수 있다.
- `restricted`: 우분투에 의해 지원되나 완전한 자유 라이선스 소프트웨어는 아니다.
- `universe`: 리눅스에서 사용할 수 있는 대부분의 소프트웨어로 자유 소프트웨어일 수도 있고 아닐 수도 있으며, 기술적 지원을 보장하지 않는다.
- `multiverse`: 자유 소프트웨어가 아닌 소프트웨어가 포함되어 있으며, 개인이 직접 라이선스를 확인해야 한다.

### 우분투 패키지의 이름 구성
- 우분투는 데비안 계열이므로 패키지 확장자는 `.deb`를 사용한다.
- 패키지 이름 형식: `패키지명_버전_데미안 리비전ubuntu우분투 리비전_아키텍쳐.deb`
    - 패키지명: 패키지의 이름이다.
    - 버전: 오리지널 패키지의 버전이다.
    - 데미안 리비전: 오리지널 패키지 버전을 데비안에 적용한 리비전 번호이다.
    - ubuntu우분투 리비전: 오리지널 또는 데비안 패키지를 우분투에 적용한 리비전 번호이다.
    - 아키텍쳐: 사용하는 시스템 아키텍쳐로 `all`은 시스템의 종류와 상관없이 사용할 수 있는 것이고, `amd64`는 64비트 운영체제임을 의미한다.
    - 확장자: 확장자로 `.deb`를 사용한다.

### 데비안 리비전ubuntu우분투 리비전
- 데비안 리비전이 0이면 이 패키지는 데비안 버전이 없거나 데비안 버전보다 새 버전임을 의미한다.
- ubuntu우분투 리비전은 데비안 패키지의 우분투 리비전 번호인데 아래의 경우의 수가 있다.
    - ubuntu우분투 리비전 부분이 없으면 데비안 패키지를 변경 없이 사용하는 것이다.
    - ubuntu우분투 리비전 부분이 있으면 데비안 패키지를 가져다가 우분투에서 기능 패치나 버그 수정 등 추가적인 작업을 했음을 의미한다.
    - `X_5.4.3-1`: 패키지 X의 5.4.3 버전의 첫번째 데비안 리비전이고 우분투에서는 데비안 리버전을 변경 없이 사용한다.
    - `X_5.4.3-2ubuntu1`: 패키지 X의 5.4.3 버전의 두번째 데비안 리비전이고 이를 바탕으로 한 첫번째 우분투 리비전이다.
    - `X_5.4.3-0ubuntu2`: 패키지 X의 5.4.3 버전의 데비안 리비전은 없고 우분투는 두번째 리비전이다.

### 우분투 패키지 저장소
- 우분투는 패키지와 패키지에 대한 정보를 저장하고 있는 서버인 패키지 저장소라는 개념을 사용한다.
- 패키지 저장소에서는 패키지의 기능 추가나 보안 패치 등 지속적인 업그레이드를 집중적으로 관리하고, 사용자는 저장소에 접속하여 최신 패키지를 내려받아 설치할 수 있다.
- 패키지 저장소에 대한 정보는 `/etc/apt/sources.list` 파일에 저장되어 있다.
```
utrm@myubuntu:~$ cat /etc/apt/sources.list
# Ubuntu sources have moved to /etc/apt/sources.list.d/ubuntu.sources
utrm@myubuntu:~$ cat /etc/apt/sources.list.d/ubuntu.sources
Types: deb
URIs: http://ports.ubuntu.com/ubuntu-ports/
Suites: noble noble-updates noble-backports
Components: main restricted universe multiverse
Signed-By: /usr/share/keyrings/ubuntu-archive-keyring.gpg

Types: deb
URIs: http://ports.ubuntu.com/ubuntu-ports/
Suites: noble-security
Components: main restricted universe multiverse
Signed-By: /usr/share/keyrings/ubuntu-archive-keyring.gpg
```
- `sources.list` 파일은 저장소의 정보를 한 줄에 하나씩 나타낸다.
- 각 행은 패키지 유형, 저장소 주소, 우분투 버전 정보, 카테고리로 구성된다.
    - 패키지 유형: `deb`는 바이너리 패키지의 저장소를, `deb-src`는 패키지의 소스 저장소를 의미한다. 보통 한 저장소에 바이너리와 소스를 함께 저장한다.
    - 저장소 주소: http 프로토콜을 사용하는 URL 주소를 사용한다,
    - 우분투 버전 정보: 저장소에서 관리하는 패키지에 해당하는 우분투의 버전을 표시한다. 버전은 번호가 아니라 버전의 이름을 사용한다.
    - 카테고리: 저장소가 가지고 있는 소프트웨어 카테고리 (main, restricted 등)을 표시한다.
- 위의 실습 내용을 보자.
    - 패키지 유형 (Types: deb)
        - `deb`: 바이너리 패키지를 포함하는 저장소를 의미한다.
	    - `deb-src`가 아닌 `deb`만 포함되어 있어, 소스 코드 패키지(`deb-src`)는 포함되지 않았다.
    - 저장소 주소 (URIs: http://ports.ubuntu.com/ubuntu-ports/)
	    - http://ports.ubuntu.com/ubuntu-ports/ → ARM, RISC-V 같은 비표준 아키텍처용 Ubuntu 패키지 저장소이다.
	    - 일반적인 x86_64 (AMD64) 시스템은 http://archive.ubuntu.com/ubuntu/를 사용하지만, ARM/RISC-V 시스템에서는 ports.ubuntu.com을 사용한다.
    - 배포 버전 (Suites:)
	    - `noble`: Ubuntu의 버전 코드네임 (예: Ubuntu 24.04 LTS의 코드네임)
	    - `noble-updates`: 해당 버전의 공식 업데이트 저장소
	    - `noble-backports`: 최신 버전의 패키지를 이전 버전에도 사용할 수 있도록 제공하는 저장소
	    - `noble-security`: 보안 패치가 제공되는 저장소
    - 패키지 카테고리 (Components:)
	    - main: 공식적으로 지원되는 오픈소스 소프트웨어
	    - restricted: 일부 제한된 라이선스를 가진 드라이버 및 소프트웨어 (예: NVIDIA 드라이버)
	    - universe: 커뮤니티가 관리하는 오픈소스 소프트웨어
	    - multiverse: 라이선스 문제로 인해 기본적으로 지원되지 않는 소프트웨어 (예: 특정 코덱)
    - GPG 서명 (Signed-By:)
	    - `/usr/share/keyrings/ubuntu-archive-keyring.gpg`: 패키지의 무결성을 검증하기 위해 GPG 키를 사용

## 02. 우분투 패키지 설치
### `APT` 명령으로 패키지 관리하기
- APT: Advanced Package Tool, 보다 편리하게 패키지를 관리할 수 있는 명령을 제공한다.

#### 1. `apt-cache` 명령
- APT 캐시 (패키지 데이터베이스) 에서 정보를 검색하여 출력한다.
- 형식: `apt-cache [옵션] [서브 명령]`
- 옵션: 
    - `-f`: 검색 결과로 패키지에 대한 전체 기록을 출력한다.
    - `-h`: 간단한 도움말을 출력한다.
- 서브 명령:
    - `stats`: 캐시에 대한 통계 정보를 출력한다.
    - `dump`: 현재 설치된 패키지를 업데이트한다.
    - `search 키워드`: 캐시에서 키워드를 검색한다.
    - `showpkg 패키지명`: 패키지에 대한 의존성 정보와 역의존성 정보를 검색하여 출력한다.
    - `show 패키지명`: 패키지에 대한 간단한 정보를 출력한다.
    - `pkgnames`: 사용 가능한 모든 패키지의 이름을 출력한다.

#### 1-1. APT 캐시 통계 정보 보기: `stats` 명령
```
utrm@myubuntu:~$ apt-cache stats
Total package names: 156835 (4,391 k)
Total package structures: 142239 (6,259 k)
  Normal packages: 78168
  Pure virtual packages: 1939
  Single virtual packages: 50956
  Mixed virtual packages: 403
  Missing: 10773
Total distinct versions: 85751 (7,546 k)
Total distinct descriptions: 164345 (3,944 k)
Total dependencies: 514177/132788 (12.4 M)
Total ver/file relations: 33378 (801 k)
Total Desc/File relations: 33273 (799 k)
Total Provides mappings: 66918 (1,606 k)
Total globbed strings: 270466 (6,811 k)
Total slack space: 93.0 k
Total space accounted for: 46.2 M
Total buckets in PkgHashTable: 196613
  Unused: 95229
  Used: 101384
  Utilization: 51.5653%
  Average entries: 1.40297
  Longest: 19
  Shortest: 1
Total buckets in GrpHashTable: 196613
  Unused: 88315
  Used: 108298
  Utilization: 55.0818%
  Average entries: 1.44818
  Longest: 8
  Shortest: 1
```
- 전체 패키지 이름: 캐시에 있는 패키지 이름의 전체 개수를 의미한다.
- 일반 패키지: 일반적으로 사용하는 패키지의 개수를 의미한다.
- 순수 가상 패키지: 가상 패키지는 패키지의 이름만 제공하며 그 이름을 가진 별도의 패키지가 실제로 있는 것은 아니다.
- 단일 가상 패키지: 한 패키지가 특정한 가상 패키지의 기능을 제공하는 경우다.
- 혼합 가상 패키지: 특정한 가상 패키지를 제공하거나 가상 패키지의 이름을 패키지 이름으로 사용하는 경우이다.
- 빠짐: 의존성은 있지만 어떠한 패키지도 제공하지 않는 패키지이다.
- 개별 버전 전체: 캐시에 있는 패키지 버전의 개수를 의미한다. 이 숫자는 전체 패키지 이름의 개수보다 작거나 그 개수와 같다.
- 전체 의존성: 캐시에 있는 모든 패키지의 의존성 관계를 의미한다.

#### 1-2. 사용 가능한 패키지 이름 보기: `pkgnames` 명령
- 사용 가능한 전체 패키지 이름을 확인한다.
```
utrm@myubuntu:~$ apt-cache pkgnames | head -n 10
gobjc++-11-multilib-mipsel-linux-gnu
lib32stdc++-11-dev-s390x-cross
bazel-bootstrap
ruby-jmespath
goverlay
libgiza0
librust-quickcheck-macros-dev
lib32gfortran-14-dev-x32-cross
r-cran-egg
r-bioc-snpstats
```

#### 1-3. 패키지 이름 검색하기: `search` 명령
- 패키지를 설치하기 전에 패키지의 이름과 간단한 설명을 검색하기 위해 사용 가능하다.
```
utrm@myubuntu:~$ apt-cache search vsftpd
vsftpd - lightweight, efficient FTP server written for security
vsftpd-dbg - lightweight, efficient FTP server written for security (debug)
ccze - robust, modular log coloriser
resource-agents-extra - Cluster Resource Agents
yasat - simple stupid audit tool
```

#### 1-4. 패키지 정보 검색하기: `show` 명령
- 버전, 패키지 크기, 카테고리, 체크섬 등 패키지에 관한 정보를 확인 가능하다.
```
utrm@myubuntu:~$ apt-cache show vsftpd | head -n 15
Package: vsftpd
Architecture: arm64
Version: 3.0.5-0ubuntu3.1
Priority: extra
Section: net
Origin: Ubuntu
Maintainer: Ubuntu Developers <ubuntu-devel-discuss@lists.ubuntu.com>
Original-Maintainer: Keng-Yu Lin <kengyu@debian.org>
Bugs: https://bugs.launchpad.net/ubuntu/+filebug
Installed-Size: 345
Provides: ftp-server
Depends: debconf (>= 0.5) | debconf-2.0, libc6 (>= 2.34), libcap2 (>= 1:2.10), libpam0g (>= 0.99.7.1), libssl3t64 (>= 3.0.0), libwrap0 (>= 7.6-4~), adduser, lsb-base (>= 3.0-6), netbase, procps, sysvinit-utils (>= 2.96)
Recommends: logrotate, ssl-cert
Conflicts: ftp-server
Replaces: ftp-server
```

#### 1-5. 패키지 의존성 검색하기: `showpkg` 명령
- 패키지의 설치 여부와 상관없이 패키지의 의존성에 대한 정보를 검색한다.
```
utrm@myubuntu:~$ apt-cache showpkg vsftpd
Package: vsftpd
Versions:
3.0.5-0ubuntu3.1 (/var/lib/apt/lists/ports.ubuntu.com_ubuntu-ports_dists_noble-updates_main_binary-arm64_Packages)
 Description Language:
  File: /var/lib/apt/lists/ports.ubuntu.com_ubuntu-ports_dists_noble_main_binary-arm64_Packages
  MD5: 81386f72ac91a5ea48f8db0b023f3f9b
 Description Language: en
  File: /var/lib/apt/lists/ports.ubuntu.com_ubuntu-ports_dists_noble_main_i18n_Translation-en
  MD5: 81386f72ac91a5ea48f8db0b023f3f9b
 Description Language:
  File: /var/lib/apt/lists/ports.ubuntu.com_ubuntu-ports_dists_noble-updates_main_binary-arm64_Packages
  MD5: 81386f72ac91a5ea48f8db0b023f3f9b

3.0.5-0ubuntu3 (/var/lib/apt/lists/ports.ubuntu.com_ubuntu-ports_dists_noble_main_binary-arm64_Packages)
 Description Language:
  File: /var/lib/apt/lists/ports.ubuntu.com_ubuntu-ports_dists_noble_main_binary-arm64_Packages
  MD5: 81386f72ac91a5ea48f8db0b023f3f9b
 Description Language: en
  File: /var/lib/apt/lists/ports.ubuntu.com_ubuntu-ports_dists_noble_main_i18n_Translation-en
  MD5: 81386f72ac91a5ea48f8db0b023f3f9b
 Description Language:
  File: /var/lib/apt/lists/ports.ubuntu.com_ubuntu-ports_dists_noble-updates_main_binary-arm64_Packages
  MD5: 81386f72ac91a5ea48f8db0b023f3f9b
  ...
```

#### 2. `apt-get` 명령
- 패키지 저장소를 업데이트하고 패키지를 설치하거나 제거할 수도 있다.
- 형식: `apt-get [옵션] [서브 명령]`
- 옵션: 
    - `-d`: 패키지를 내려받기만 한다.
    - `-f`: 의존성이 깨진 패키지를 수정하려고 시도한다.
    - `-h`: 간단한 도움말을 출력한다.
- 서브 명령:
    - `update`: 패키지 저장소에서 새로운 패키지 정보를 가져온다.
    - `upgrade`: 현재 설치된 패키지를 업그레이드 한다.
    - `install 패키지명`: 패키지를 설치한다.
    - `remove 패키지명`: 패키지를 삭제한다.
    - `download 패키지명`: 패키지를 형재 디렉토리로 내려받는다.
    - `autoclean`: 불완전하게 내려받았거나 오래된 패키지를 삭제한다.
    - `clean`: `/var/cache/apt/archives`에 캐시되어 있는 모든 패키지를 삭제하여 디스크 공간을 확보한다.
    - `check`: 의존성이 깨진 패키지를 확인한다.

#### 2-1. 패키지 정보 업데이트하기: `update` 명령
- `/etc/apt/sources.list` 에 명시한 저장소로부터 패키지 정보를 읽어 동기화한다.
```
utrm@myubuntu:~$ sudo apt-get update
[sudo] password for utrm:
Hit:1 http://ports.ubuntu.com/ubuntu-ports noble InRelease
Get:2 http://ports.ubuntu.com/ubuntu-ports noble-updates InRelease [126 kB]
Get:3 http://ports.ubuntu.com/ubuntu-ports noble-backports InRelease [126 kB]
Get:4 http://ports.ubuntu.com/ubuntu-ports noble-security InRelease [126 kB]
Get:5 http://ports.ubuntu.com/ubuntu-ports noble-updates/main arm64 Packages [923 kB]
Err:5 http://ports.ubuntu.com/ubuntu-ports noble-updates/main arm64 Packages
  Hash Sum mismatch
  Hashes of expected file:
   - Filesize:923104 [weak]
   - SHA256:4f78c6c672061597e145ea02d45cd0e22809dca25f2fa527005d9bdb183815b5
   - SHA1:5f65d9206514b5c2e8e62a4fadaca2d17c690 [weak]
   - MD5Sum:7877c736bc37b1fd642e462a9eb550ad [weak]
  Hashes of received file:
   - SHA256:77fe68be0ee51c3a0d7e5dfe1f9ddb79e30a246e9be20f838c6273190c342448
   - SHA1:4adc7a89d5d7b62db2a9e213a78ba15615f8945 [weak]
   - MD5Sum:d014fc2f7ae622287d3a51af9f858f22 [weak]
   - Filesize:923104 [weak]
  Last modification reported: Tue, 18 Mar 2025 04:21:57 +0000
  Release file created at: Tue, 18 Mar 2025 05:59:00 +0000
Get:6 http://ports.ubuntu.com/ubuntu-ports noble-updates/main Translation-en [209 kB]
Get:7 http://ports.ubuntu.com/ubuntu-ports noble-updates/main arm64 Components [148 kB]
Get:8 http://ports.ubuntu.com/ubuntu-ports noble-updates/main arm64 c-n-f Meta data [13.1 kB]
Get:9 http://ports.ubuntu.com/ubuntu-ports noble-updates/restricted arm64 Components [212 B]
```

#### 2-2. 패키지 업그레이드하기: `upgrade` 명령
- 현재 설치된 모든 패키지 중에서 새로운 버전이 나온 모든 패키지를 모두 업그레이드한다.
```
utrm@myubuntu:~$ sudo apt-get upgrade
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
Calculating upgrade... Done
The following upgrades have been deferred due to phasing:
  ubuntu-drivers-common
The following packages will be upgraded:
  apport apport-core-dump-handler apport-gtk libmalcontent-0-0
  python3-apport python3-problem-report snapd sosreport
8 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
Need to get 27.6 MB of archives.
After this operation, 388 kB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 http://ports.ubuntu.com/ubuntu-ports noble-updates/main arm64 python3-problem-report all 2.28.1-0ubuntu3.5 [24.9 kB]
Get:2 http://ports.ubuntu.com/ubuntu-ports noble-updates/main arm64 python3-apport all 2.28.1-0ubuntu3.5 [92.4 kB]
Get:3 http://ports.ubuntu.com/ubuntu-ports noble-updates/main arm64 apport-core-dump-handler all 2.28.1-0ubuntu3.5 [17.9 kB]
Get:4 http://ports.ubuntu.com/ubuntu-ports noble-updates/main arm64 apport all 2.28.1-0ubuntu3.5 [84.7 kB]
Get:5 http://ports.ubuntu.com/ubuntu-ports noble-updates/main arm64 apport-gtk all 2.28.1-0ubuntu3.5 [9,748 B]
Get:6 http://ports.ubuntu.com/ubuntu-ports noble-updates/main arm64 libmalcontent-0-0 arm64 0.11.1-1ubuntu1.1 [15.5 kB]
Get:7 http://ports.ubuntu.com/ubuntu-ports noble-updates/main arm64 snapd arm64 2.67.1+24.04 [27.0 MB]
Get:8 http://ports.ubuntu.com/ubuntu-ports noble-updates/main arm64 sosreport
```

#### 2-3. 특정 패키지 설치 또는 업그레이드하기: `install` 명령
- 하나 이상의 패키지를 설치하거나 업그레이드할 때 사용한다.
```
utrm@myubuntu:~$ sudo apt-get install xterm
[sudo] password for utrm:
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
Suggested packages:
  xfonts-cyrillic
Recommended packages:
  luit | x11-utils
The following NEW packages will be installed:
  xterm
0 upgraded, 1 newly installed, 0 to remove and 1 not upgraded.
Need to get 886 kB of archives.
After this operation, 2,564 kB of additional disk space will be used.
Get:1 http://ports.ubuntu.com/ubuntu-ports noble/universe arm64 xterm arm64 390-1ubuntu3 [886 kB]
Fetched 886 kB in 3s (327 kB/s)
Selecting previously unselected package xterm.
(Reading database ... 174566 files and directories currently installed.)
Preparing to unpack .../xterm_390-1ubuntu3_arm64.deb ...
Unpacking xterm (390-1ubuntu3) ...
Setting up xterm (390-1ubuntu3) ...
Processing triggers for hicolor-icon-theme (0.17-2) ...
Processing triggers for gnome-menus (3.36.0-1.1ubuntu3) ...
Processing triggers for man-db (2.12.0-4build2) ...
Processing triggers for desktop-file-utils (0.27-2build1) ...
Scanning processes...
Scanning linux images...

Running kernel seems to be up-to-date.
```
- 여려 패키지를 한번에 설치하려면 아래와 같이 작성한다.
```
utrm@myubuntu:~$ sudo apt-get install xterm goaccess
```
- 패키지를 설치할 때 업그레이드를 하지 않으려면 `--no--upgrade` 옵션을 사용한다.
```
utrm@myubuntu:~$ sudo apt-get install xterm --no--upgrade
```
- 새로운 패키지를 설치하지 않고 업그레이드만 할 때는 `--only--upgrade` 옵션을 사용한다.
```
utrm@myubuntu:~$ sudo apt-get install netcat --only--upgrade
```

#### 2-4. 패키지 삭제하기: `remove` 명령
- 설치된 패키지를 삭제할 때 사용한다.
```
utrm@myubuntu:~$ sudo apt-get remove xterm
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following packages will be REMOVED:
  xterm
0 upgraded, 0 newly installed, 1 to remove and 1 not upgraded.
After this operation, 2,564 kB disk space will be freed.
Do you want to continue? [Y/n] y
(Reading database ... 174617 files and directories currently installed.)
Removing xterm (390-1ubuntu3) ...
Processing triggers for hicolor-icon-theme (0.17-2) ...
Processing triggers for gnome-menus (3.36.0-1.1ubuntu3) ...
Processing triggers for man-db (2.12.0-4build2) ...
Processing triggers for desktop-file-utils (0.27-2build1) ...
```
- `remove` 명령은 나중에 같은 패키지를 설치할 때 재활용하기 위해 삭제할 때 해당 패키지의 설정 파일을 남겨둔다.
- 설정 파일도 포함하여 삭제하려면 `purge` 서브 명령을 사용하거나, `--purge` 옵션으로 사용할 수 있다.
```
utrm@myubuntu:~$ sudo apt-get purge xterm
utrm@myubuntu:~$ sudo apt-get remove --purge xterm
```

#### 2-5. 패키지 자동 정리 및 삭제하기: `autoremove` 명령
- 자동으로 설치되었으나 필요 없는 패키지를 삭제할 수 있다.
```
utrm@myubuntu:~$ sudo apt-get autoremove
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
```

- 검색했거나 내려받은 패키지 파일을 삭제하고 디스크 공간을 정리할 때 사용한다.
```
utrm@myubuntu:~$ sudo apt-get clean
```

#### 2-7. 패키지 내려받기: `download` 명령
- 패키지를 설치하지 않고 내려받기만 할 때 사용한다.
```
utrm@myubuntu:~$ sudo apt-get download xterm
Get:1 http://ports.ubuntu.com/ubuntu-ports noble/universe arm64 xterm arm64 390-1ubuntu3 [886 kB]
Fetched 886 kB in 3s (346 kB/s)
W: Download is performed unsandboxed as root as file '/home/utrm/xterm_390-1ubuntu3_arm64.deb' couldn't be accessed by user '_apt'. - pkgAcquire::Run (13: Permission denied)
```

#### 2-8. 패키지의 소스 관련 서브 명령: `source` 명령
- 보통 바이너리 패키지를 설치하지만 때에 따라 패키지의 소스 코드로 작업해야 하는 경우가 있다.
- 특정 패키지의 소스 코드를 내려받기만 하는 경우
```
utrm@myubuntu:~$ sudo apt-get --download-only source 패키지명
```
- 특정 패키지의 소스 코드를 내려받고 압축을 푸는 경우
```
utrm@myubuntu:~$ sudo apt-get source 패키지명
```
- 특정 패키지의 소스 코드를 내려받아 압축을 풀고 컴파일하는 경우
```
utrm@myubuntu:~$ sudo apt-get --compile source 패키지명
```

#### 추가적으로...

|`apt` 명령|`apt-get`, `apt-cache` 명령|기능|
|:---:|:---:|:---:|
|`apt update`|`apt-get update`|패키지 저장소의 새로운 패키지 정보를 가져온다.|
|`apt upgrade`|`apt-get upgrade`|패키지를 업그레이드한다.|
|`apt install`|`apt-get install`|패키지를 설치한다.|
|`apt remove`|`apt-get remove`|패키지를 삭제한다.|
|`apt purge`|`apt-get purge`|패키지와 설정 파일을 삭제한다.|
|`apt autoremove`|`apt-get autoremove`|필요 없는 패키지를 삭제한다.|
|`apt search`|`apt-cache search`|캐시에서 키워드로 패키지를 검색한다.|
|`apt show`|`apr-cache show`|패키지의 간단한 정보를 출력한다.|
|`apt list`||조건에 맞는 패키지 목록을 출력한다.|

### `dpkg` 명령으로 패키지 관리하기
- 이 명령은 데비안 계열의 리눅스에서 패키지를 관리하는데 사용한다.
- `APT` 명령도 내부적으로는 `dpkg` 명령을 사용한다.
- 형식: `dpkg [옵션] [파일명 또는 패키지명]`
- 옵션:
    - `-l`: 설치된 패키지의 목록을 출력한다.
    - `-l 패키지명`: 패키지의 설치 상태를 출력한다.
    - `-s 패키지명`: 패키지의 상세 정보를 출력한다.
    - `-S 경로명`: 경로명이 포함된 패키지를 검색한다.
    - `-L 패키지명`: 패키지에서 설치된 파일의 목록을 출력한다.
    - `-c .deb 파일`: 지정한 `.deb`파일의 내용을 출력한다.
    - `-i .deb 파일`: 해당 파일을 설치한다. (`sudo`)
    - `-r 패키지명`: 해당 패키지를 삭제한다. (`sudo`)
    - `-P 패키지명`: 해당 패키지와 설정 정보를 모두 삭제한다. (`sudo`)
    - `-x .deb 파일 디렉토리`: 해당 파일을 지정한 디렉토리에 풀어놓는다.

#### 1. 패키지 목록 보기: `-l` 옵션
- 설치된 패키지의 목록이 출력된다.
- 출력 결과의 첫 글자는 희망 상태, 두번째 글자는 상태를 나타낸다.
```
xutrm@myubuntu:~$ dpkg -l
Desired=Unknown/Install/Remove/Purge/Hold
| Status=Not/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend
|/ Err?=(none)/Reinst-required (Status,Err: uppercase=bad)
||/ Name                                        Version
+++-============================================-=============================
ii  accountsservice                             23.13.9-2ubuntu6
ii  acl                                         2.3.2-1build1.1
ii  adduser                                     3.137ubuntu1
ii  adwaita-icon-theme                          46.0-1
ii  alsa-base                                   1.0.25+dfsg-0ubuntu7
ii  alsa-topology-conf                          1.2.5.1-2
ii  alsa-ucm-conf                               1.2.10-1ubuntu5.4
ii  alsa-utils                                  1.2.9-1ubuntu5
ii  anacron                                     2.3-39ubuntu2
ii  apg                                         2.3.dfsg.1-5build3
ii  apparmor                                    4.0.1really4.0.1-0ubuntu0.2
ii  apport                                      2.28.1-0ubuntu3.5
ii  apport-core-dump-handler                    2.28.1-0ubuntu3.5
ii  apport-gtk                                  2.28.1-0ubuntu3.5
ii  apport-symptoms                             0.25
ii  appstream                                   1.0.2-1build6
ii  apt                                         2.7.14build2
ii  apt-config-icons                            1.0.2-1build6
ii  apt-config-icons-hidpi                      1.0.2-1build6
ii  apt-utils                                   2.7.14build2
ii  aptdaemon                                   1.1.1+bzr982-0ubuntu44
ii  aptdaemon-data                              1.1.1+bzr982-0ubuntu44
```
- `-l`에 특정 패키지 이름을 지정하면 해당 패키지에 대한 정보를 출력한다.
```
utrm@myubuntu:~$ dpkg -l zip
Desired=Unknown/Install/Remove/Purge/Hold
| Status=Not/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend
|/ Err?=(none)/Reinst-required (Status,Err: uppercase=bad)
||/ Name       Version             Architecture Description
+++-==========-===================-============-===============================
ii  zip       3.0-13ubuntu0.2      arm64        Archiver for .zip files
```

#### 2. 패키지 상세 정보 보기: `-s` 옵션
- 패키지 상세 정보를 볼 때 사용한다.
```
utrm@myubuntu:~$ dpkg -s zip
Package: zip
Status: install ok installed
Priority: optional
Section: utils
Installed-Size: 532
Maintainer: Ubuntu Developers <ubuntu-devel-discuss@lists.ubuntu.com>
Architecture: arm64
Multi-Arch: foreign
Version: 3.0-13ubuntu0.2
Depends: libbz2-1.0, libc6 (>= 2.34)
Recommends: unzip
Description: Archiver for .zip files
 This is InfoZIP's zip program. It produces files that are fully
 compatible with the popular PKZIP program; however, the command line
 options are not identical. In other words, the end result is the same,
 but the methods differ. :-)
 .
 This version supports encryption.
Homepage: https://infozip.sourceforge.net/Zip.html
Original-Maintainer: Santiago Vila <sanvila@debian.org>
```

#### 3. 특정 파일이 포함된 패키지 검색하기: `-S` 옵션
- 특정 파일이 포한된 패키지를 검색할 때 사용한다.
```
utrm@myubuntu:~$ dpkg -S /bin/ls
dpkg-query: no path found matching pattern /bin/ls

utrm@myubuntu:~$ dpkg -S /etc/apt
aptdaemon, packagekit, debconf, command-not-found, apt, appstream, update-notifier-common, unattended-upgrades, ubuntu-pro-client, ubuntu-keyring, needrestart, apt-config-icons-hidpi, apt-config-icons, snapd: /etc/apt
```

#### 4. 패키지가 설치한 파일 목록 검색하기: `-L` 옵션
- 지정한 패키지가 설치한 파일의 목록을 검색할 때 사용한다.
```
utrm@myubuntu:~$ dpkg -L zip
/.
usr
/usr/bin
/usr/bin/zip
/usr/bin/zipcloak
/usr/bin/zipnote
/usr/bin/zipsplit
/usr/share
/usr/share/doc
/usr/share/doc/zip
/usr/share/doc/zip/TODO
/usr/share/doc/zip/WHATSNEW
/usr/share/doc/zip/changelog.Debian.gz
/usr/share/doc/zip/copyright
/usr/share/man
/usr/share/man/man1
/usr/share/man/man1/zip.1.gz
/usr/share/man/man1/zipcloak.1.gz
/usr/share/man/man1/zipnote.1.gz
/usr/share/man/man1/zipsplit.1.gz
/usr/share/doc/zip/changelog.gz
```

#### 5. 패키지의 파일 목록 검색하기: `-c` 옵션
- `.deb` 파일에 들어 있는 내용을 출력한다.
```
utrm@myubuntu:~$ dpkg -c xterm_390-1ubuntu3_arm64.deb
drwxr-xr-x root/root         0 2024-03-31 17:32 ./
drwxr-xr-x root/root         0 2024-03-31 17:32 ./etc/
drwxr-xr-x root/root         0 2024-03-31 17:32 ./etc/X11/
drwxr-xr-x root/root         0 2024-03-31 17:32 ./etc/X11/app-defaults/
-rw-r--r-- root/root      2400 2024-03-31 17:32 ./etc/X11/app-defaults/KOI8RXTerm
-rw-r--r-- root/root      6217 2024-03-31 17:32 ./etc/X11/app-defaults/KOI8RXTerm-color
-rw-r--r-- root/root      3706 2024-03-31 17:32 ./etc/X11/app-defaults/UXTerm
-rw-r--r-- root/root      6209 2024-03-31 17:32 ./etc/X11/app-defaults/UXTerm-color
-rw-r--r-- root/root     10939 2024-03-31 17:32 ./etc/X11/app-defaults/XTerm
-rw-r--r-- root/root      6207 2024-03-31 17:32 ./etc/X11/app-defaults/XTerm-color
drwxr-xr-x root/root         0 2024-03-31 17:32 ./usr/
drwxr-xr-x root/root         0 2024-03-31 17:32 ./usr/bin/
-rwxr-xr-x root/root      3760 2024-03-31 17:32 ./usr/bin/koi8rxterm
-rwxr-xr-x root/root       419 2024-03-31 17:32 ./usr/bin/lxterm
-rwxr-xr-x root/root     67572 2024-03-31 17:32 ./usr/bin/resize
-rwxr-xr-x root/root      4250 2024-03-31 17:32 ./usr/bin/uxterm
-rwxr-xr-x root/root    889512 2024-03-31 17:32 ./usr/bin/xterm
drwxr-xr-x root/root         0 2024-03-31 17:32 ./usr/share/
drwxr-xr-x root/root         0 2024-03-31 17:32 ./usr/share/applications/
-rw-r--r-- root/root      1964 2024-03-31 17:32 ./usr/share/applications/debian-uxterm.desktop
-rw-r--r-- root/root      1972 2024-03-31 17:32 ./usr/share/applications/debian-xterm.desktop
drwxr-xr-x root/root         0 2024-03-31 17:32 ./usr/share/doc/
drwxr-xr-x root/root         0 2024-03-31 17:32 ./usr/share/doc/xterm/
-rw-r--r-- root/root      1817 2024-02-20 17:13 ./usr/share/doc/xterm/README.D
...
```

#### 6. 패키지 설치하기: `-i` 옵션
- 패키지를 설치할 때 사용한다.
- 패키지를 설치하려면 `root` 권한이 필요하므로 `sudo` 명령을 사용해야 한다.
- `APT` 명령과 달리 `dpkg` 명령은 의종성이 있는 패키지를 자동으로 설치하지 않으므로 일일히 설치해야 한다.
```
utrm@myubuntu:~$ sudo dpkg -i xterm_390-1ubuntu3_arm64.deb
Selecting previously unselected package xterm.
(Reading database ... 174572 files and directories currently installed.)
Preparing to unpack xterm_390-1ubuntu3_arm64.deb ...
Unpacking xterm (390-1ubuntu3) ...
Setting up xterm (390-1ubuntu3) ...
Processing triggers for gnome-menus (3.36.0-1.1ubuntu3) ...
Processing triggers for desktop-file-utils (0.27-2build1) ...
Processing triggers for hicolor-icon-theme (0.17-2) ...
Processing triggers for man-db (2.12.0-4build2) ...
```

#### 7. 패키지 삭제하기: `-r`, `-P` 옵션
- `-r`: 설치된 패키지만 삭제한다.
- `-P`: 패키지와 설정 정보를 모두 삭제한다.
```
utrm@myubuntu:~$ sudo dpkg -P xterm
(Reading database ... 174617 files and directories currently installed.)
Removing xterm (390-1ubuntu3) ...
Purging configuration files for xterm (390-1ubuntu3) ...
Processing triggers for man-db (2.12.0-4build2) ...
Processing triggers for hicolor-icon-theme (0.17-2) ...
Processing triggers for gnome-menus (3.36.0-1.1ubuntu3) ...
Processing triggers for desktop-file-utils (0.27-2build1) ...
```

#### 8. `deb` 패키지 풀기: `-x` 옵션
- `deb` 패키지의 내용을 지정한 디렉토리에 풀어놓는다.
```
utrm@myubuntu:~$ mkdir xterm
utrm@myubuntu:~$ sudo dpkg -x xterm_390-1ubuntu3_arm64.deb xterm
utrm@myubuntu:~$ ls -R xterm
xterm:
etc  usr

xterm/etc:
X11

xterm/etc/X11:
app-defaults

xterm/etc/X11/app-defaults:
KOI8RXTerm  KOI8RXTerm-color  UXTerm  UXTerm-color  XTerm  XTerm-color

xterm/usr:
bin  share

xterm/usr/bin:
koi8rxterm  lxterm  resize  uxterm  xterm

xterm/usr/share:
applications  doc  doc-base  icons  man  pixmaps

xterm/usr/share/applications:
debian-uxterm.desktop  debian-xterm.desktop

xterm/usr/share/doc:
...
```

### `aptitude` 명령으로 패키지 관리하기
- `APT` 명령처럼 패키지 관리를 자동화하여 쉽게 작업할 수 있도록 한다.
- 옵션이나 서브 명령 없이 실행할 경우 `curses`를 이용한 비주얼 모드로 동작한다.
- 형식: `aptitude [서브 명령]`
- 서브 명령:
    - 단독 실행: `curses` 프로그램이 나타난다.
    - `search 키워드`: 키워드를 검색하여 일치하는 패키지 목록을 출력한다.
    - `update`: 패키지 저장소를 업데이트한다.
    - `upgrade`: 모든 패키지를 최신 버전으로 업그레이드한다.
    - `show 패키지명`: 패키지에 대한 자세한 정보를 보여준다.
    - `download 패키지명`: 패키지를 내려받는다.
    - `clean`: 패키지 캐시 디렉토리에서 모든 패키지 파일을 삭제한다.
    - `install`: 패키지를 설치한다.
    - `remove`: 패키지를 삭제한다.
    - `purge`: 패키지와 설정 파일을 모두 삭제한다.

#### 1. `aptitude` 명령 단독으로 실행하기
- 설치되어 있지 않다면 `apt` 명령으로 설치하기
```
utrm@myubuntu:~$ sudo aptitude
sudo: aptitude: command not found
utrm@myubuntu:~$ sudo apt install aptitude
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following additional packages will be installed:
  aptitude-common libcdwidget4 libdpkg-perl libfile-fcntllock-perl
  libsigc++-2.0-0v5 libxapian30
Suggested packages:
  apt-xapian-index aptitude-doc-en | aptitude-doc debtags tasksel
  libcdwidget-dev debian-keyring bzr xapian-tools
The following NEW packages will be installed:
  aptitude aptitude-common libcdwidget4 libdpkg-perl libfile-fcntllock-perl
  libsigc++-2.0-0v5 libxapian30
0 upgraded, 7 newly installed, 0 to remove and 1 not upgraded.
Need to get 4,149 kB of archives.
After this operation, 18.6 MB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 http://ports.ubuntu.com/ubuntu-ports noble/universe arm64 aptitude-common all 0.8.13-5ubuntu5 [1,800 kB]
Get:2 http://ports.ubuntu.com/ubuntu-ports noble/main arm64 libsigc++-2.0-0v5 arm64 2.12.1-2 [12.7 kB]
Get:3 http://ports.ubuntu.com/ubuntu-ports noble/universe arm64 libcdwidget4 arm64 0.5.18-6build1 [228 kB]
Get:4 http://ports.ubuntu.com/ubuntu-ports noble/universe arm64 libxapian30 arm64 1.4.22-1build1 [680 kB]
Get:5 http://ports.ubuntu.com/ubuntu-ports noble/universe arm64 aptitude arm64
```

## 03. 스냅 패키지 설치
## 04. 파일 아카이브와 압축
## 05. 소프트웨어 컴파일
